"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6330],{36330:(e,s,t)=>{t.r(s),t.d(s,{default:()=>g});var a=t(61134),n=t(72791),l=t(81364),r=t(55294),c=t(78983),i=t(63334),o=t(16157),d=t(67638),h=t(51910),m=t(47022),u=t(89743),p=t(62591),x=t(80184);const j=()=>{let{register:e,handleSubmit:s,reset:t,formState:{errors:i}}=(0,a.cI)();const[d,j]=(0,n.useState)(!1),[g,f]=(0,n.useState)([]),[v,b]=(0,n.useState)(""),[y,N]=(0,n.useState)(""),[S,k]=(0,n.useState)(""),[A,_]=(0,n.useState)(""),[w,Z]=(0,n.useState)(""),[C,P]=(0,n.useState)("");let[M,T]=(0,n.useState)(!0);const z=()=>j(!1),[B,E]=(0,n.useState)([]);return(0,n.useEffect)((()=>{!function(){let e=(0,l.Do)(l.vA);r.Z.get(l.ys+"admin/hotel-view_markup_details",{headers:{Authorization:"Bearer ".concat(e),Content_Type:"application-json"}}).then((e=>{console.log(e.data),E(e.data.recordset),T(!1)})).catch((e=>{console.log(e),T(!1)}))}()}),[]),(0,x.jsx)(x.Fragment,{children:M?(0,x.jsx)("div",{children:(0,x.jsx)("span",{className:"spinner-border text-primary"})}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(c.rb,{children:(null===B||void 0===B?void 0:B.length)>0&&Object.values(B.reduce(((e,s)=>(e[s.planName]||(e[s.planName]=[]),e[s.planName].push(s),e)),{})).map(((e,s)=>(0,x.jsx)(c.b7,{sm:6,lg:3,children:(0,x.jsx)(c.co,{style:{height:"87px"},className:"mb-4",color:s%6===0?"primary":s%6===1?"danger":s%6===2?"warning":s%6===3?"success":s%6===4?"secondary":"info",value:(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("span",{style:{fontSize:"smaller"},children:e[0].planName})}),title:"Status: ".concat(e[0].status),action:(0,x.jsx)(o.Z,{className:"btn btn-sm",onClick:()=>((e,s,t)=>{let a=B.filter((s=>s.planName===e));console.log(a);let n=[...new Set(a.map((e=>e.supplier)))].join(", "),l=Array.from(new Map(a.map((e=>[e.agentEmail,e]))).values());b(e),f(l),N(s),k(t),P(n),j(!0)})(e[0].planName,e[0].markupType,e[0].markupValue),variant:"info",children:"Get Info"})})},s)))}),(0,x.jsxs)(h.Z,{show:d,onHide:z,centered:!0,size:"lg",children:[(0,x.jsx)(h.Z.Header,{closeButton:!0,children:(0,x.jsxs)(m.Z,{children:[(0,x.jsx)(u.Z,{children:(0,x.jsx)(h.Z.Title,{children:v})}),(0,x.jsxs)("span",{children:["( ",(0,x.jsx)("b",{children:"Type:"})," ",y]})," | ",(0,x.jsxs)("span",{children:[(0,x.jsx)("b",{children:"Value:"})," ",S]})," | ",(0,x.jsxs)("span",{children:[(0,x.jsx)("b",{children:"Suppliers:"})," ",C]}),")"]})}),(0,x.jsx)(h.Z.Body,{children:(0,x.jsxs)("form",{children:[(0,x.jsxs)("div",{className:"row",children:[(0,x.jsx)("br",{}),(0,x.jsx)("div",{style:{height:"180px"},className:"table-responsive",children:(0,x.jsxs)(p.Z,{responsive:!0,hover:!0,children:[(0,x.jsx)("thead",{style:{position:"sticky",top:0},children:(0,x.jsxs)("tr",{children:[(0,x.jsx)("th",{children:"ID"}),(0,x.jsx)("th",{children:"Agent"}),(0,x.jsx)("th",{children:"Name"}),(0,x.jsx)("th",{children:"Contact"})]})}),(0,x.jsx)("tbody",{children:g.map(((e,s)=>(0,x.jsxs)("tr",{children:[(0,x.jsx)("td",{children:s+1}),(0,x.jsx)("td",{children:e.agentEmail}),(0,x.jsxs)("td",{children:[e.FirstName," ",e.LastName]}),(0,x.jsx)("td",{children:e.PhoneNumber})]},s)))})]})})]}),(0,x.jsx)("hr",{}),(0,x.jsx)("div",{className:"mb d-flex justify-content-between align-items-center",children:(0,x.jsx)(o.Z,{variant:"secondary",onClick:z,children:"Close"})})]})})]})]})})},g=()=>{let{register:e,handleSubmit:s,reset:t,formState:{errors:h}}=(0,a.cI)();const[m,u]=(0,n.useState)([]),[p,g]=(0,n.useState)([]),[f,v]=(0,n.useState)([]),[b,y]=(0,n.useState)(!1),[N,S]=(0,n.useState)(!1),[k,A]=(0,n.useState)(!1);function _(){let e=(0,l.Do)(l.vA);r.Z.get(l.ys+"admin/hotel-fetchMarkupAgents",{headers:{Authorization:"Bearer ".concat(e),Content_Type:"application-json"}}).then((e=>{console.log(e.data.recordset),u(e.data.recordset.markUps),g(e.data.recordset.aspNetUsers.map((e=>({value:e.UserName,label:e.UserName}))))})).catch((e=>{console.log(e)}))}return(0,n.useEffect)((()=>{_()}),[]),(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(c.xH,{className:"mb-4",children:(0,x.jsxs)(c.sl,{children:[(0,x.jsxs)(c.bn,{children:[(0,x.jsx)("div",{style:{textAlign:"center"},children:(0,x.jsx)("h2",{children:(0,x.jsx)("b",{children:" Allot New Markup "})})}),(0,x.jsx)("br",{}),(0,x.jsx)("form",{onSubmit:s((function(e){let s=f.map((e=>e.value));if(e={MarkupPlans:e.MarkupPlans,agents:s},console.log(e),""===e.MarkupPlans)(0,l.Jc)("Choose Markup Plan");else if(0===e.agents.length)(0,l.Jc)("Choose Agents");else{let s=(0,l.Do)(l.vA);r.Z.post(l.ys+"admin/hotel-travelAgentsFlightMarkups",e,{headers:{Authorization:"Bearer ".concat(s),Content_Type:"application-json"}}).then((e=>{!1===e.data.error?(console.log(e.data),t(),_(),v([]),S((e=>!e)),(0,l.Qm)(e.data.message)):(0,l.Jc)(e.data.message)})).catch((e=>{console.log(e)}))}})),children:(0,x.jsxs)("div",{className:"row",children:[(0,x.jsxs)("div",{className:"col-sm-4",children:[(0,x.jsx)("span",{children:"Markup Plans"}),(0,x.jsxs)("select",{...e("MarkupPlans"),className:"form-control",children:[(0,x.jsx)("option",{value:"",children:"All"}),m.map((e=>(0,x.jsx)("option",{value:e.id,children:e.planName},e.id)))]})]}),(0,x.jsxs)("div",{className:"col-sm-4",children:[(0,x.jsx)("span",{children:"Travel Agents"}),(0,x.jsx)(i.ZP,{value:f,onChange:v,options:[{value:"All",label:"All"},...p],isMulti:!0,menuPortalTarget:document.body,styles:{menuPortal:e=>({...e,zIndex:9999}),menu:e=>({...e,maxHeight:200,overflowY:"auto"})}},k?"reload":"no_reload")]}),(0,x.jsxs)("div",{className:"col-sm-4",children:[(0,x.jsx)("span",{style:{visibility:"hidden"},children:"Booking Status"}),(0,x.jsx)("br",{}),(0,x.jsx)(o.Z,{variant:"primary",className:"w-100",type:"submit",children:"Add"})]})]})})]}),(0,x.jsxs)("div",{style:{textAlign:"center",marginTop:"40px",marginBottom:"15px"},children:[(0,x.jsxs)("h2",{children:[(0,x.jsx)("img",{src:d,alt:"Delete Icon"}),(0,x.jsx)("b",{children:" Already Alloted Markups "})]}),(0,x.jsx)("span",{children:"(Get Details of those agents who have enrolled in these Plans)"})]}),(0,x.jsx)(j,{},N?"reload":"no_reload")]})})})}},47022:(e,s,t)=>{t.d(s,{Z:()=>o});var a=t(81694),n=t.n(a),l=t(72791),r=t(10162),c=t(80184);const i=l.forwardRef(((e,s)=>{let{bsPrefix:t,fluid:a=!1,as:l="div",className:i,...o}=e;const d=(0,r.vE)(t,"container"),h="string"===typeof a?"-".concat(a):"-fluid";return(0,c.jsx)(l,{ref:s,...o,className:n()(i,a?"".concat(d).concat(h):d)})}));i.displayName="Container";const o=i},89743:(e,s,t)=>{t.d(s,{Z:()=>o});var a=t(81694),n=t.n(a),l=t(72791),r=t(10162),c=t(80184);const i=l.forwardRef(((e,s)=>{let{bsPrefix:t,className:a,as:l="div",...i}=e;const o=(0,r.vE)(t,"row"),d=(0,r.pi)(),h=(0,r.zG)(),m="".concat(o,"-cols"),u=[];return d.forEach((e=>{const s=i[e];let t;delete i[e],null!=s&&"object"===typeof s?({cols:t}=s):t=s;const a=e!==h?"-".concat(e):"";null!=t&&u.push("".concat(m).concat(a,"-").concat(t))})),(0,c.jsx)(l,{ref:s,...i,className:n()(a,o,...u)})}));i.displayName="Row";const o=i},67638:(e,s,t)=>{e.exports=t.p+"static/media/Tick3.132b2808f2cb2b0de9dd.gif"}}]);
//# sourceMappingURL=6330.3e068a57.chunk.js.map